{% extends "base.html" %}
{% block content %}
<h1 class="mb-4 text-center">ðŸŽ§ My Record Collection</h1>

<form method="get" action="{{ url_for('search') }}" class="d-flex mb-4">
    <input type="text" name="q" class="form-control me-2" placeholder="Search by artist, title, or genre"
           value="{{ query if query else '' }}">
    <button type="submit" class="btn btn-outline-light">Search</button>
</form>

<table class="table table-dark table-striped table-hover align-middle">
    <thead>
        <tr>
            <th>Artist</th><th>Title</th><th>Song</th><th>Label</th><th>Podcast</th>
            <th>Genre</th><th>BPM</th><th>Key</th><th>Album Art</th><th>Preview</th><th>Actions</th>
        </tr>
    </thead>
    <tbody>
        {% for song in songs %}
        <tr>
            <td>{{ song.artist }}</td>
            <td>{{ song.title }}</td>
            <td>{{ song.song }}</td>
            <td>{{ song.label }}</td>
            <td>{{ song.podcast_played_on }}</td>
            <td>{{ song.genre }}</td>
            <td>{{ song.bpm }}</td>
            <td>{{ song.song_key }}</td>
            <td>
                {% if song.album_art_url %}
                    <img src="{{ song.album_art_url }}" alt="Album Art" width="50" height="50" class="rounded">
                {% else %}
                    <span class="text-muted">No Image</span>
                {% endif %}
            </td>
            <td>
                {% if song.preview_url %}
                    <audio controls>
                        <source src="{{ song.preview_url }}" type="audio/mpeg">
                    </audio>
                {% else %}
                    <span class="text-muted">No Preview</span>
                {% endif %}
            </td>
            <td>
                <a href="{{ url_for('edit_song', song_id=song.id) }}" class="btn btn-sm btn-warning">Edit</a>
                <a href="{{ url_for('delete_song', song_id=song.id) }}" class="btn btn-sm btn-danger"
                   onclick="return confirm('Delete this song?')">Delete</a>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<p class="text-center text-muted mt-4">Total Songs: {{ songs|length }}</p>
{% endblock %}
